<!-- Open Graph Meta Tags for Social Media Previews -->
{% block social_meta %}
{% if article %}
    <!-- Article specific meta tags -->
    <meta property="og:type" content="article">
    <meta property="og:title" content="{{ article.title }}">
    <meta property="og:description" content="{% if article.summary %}{{ article.summary|striptags|truncate(160) }}{% else %}{{ article.content|striptags|truncate(160) }}{% endif %}">
    <meta property="og:url" content="{{ SITEURL }}/{{ article.url }}">
    <meta property="og:site_name" content="{{ SITENAME }}">
    <meta property="og:locale" content="es_MX">
    
    <!-- Facebook App ID (optional but recommended) -->
    {% if FB_APP_ID %}
    <meta property="fb:app_id" content="{{ FB_APP_ID }}">
    {% endif %}
    
    <!-- Article meta -->
    <meta property="article:author" content="{{ article.author }}">
    <meta property="article:published_time" content="{{ article.date.isoformat() }}">
    {% if article.modified %}
    <meta property="article:modified_time" content="{{ article.modified.isoformat() }}">
    {% endif %}
    {% if article.category %}
    <meta property="article:section" content="{{ article.category }}">
    {% endif %}
    {% if article.tags %}
    {% for tag in article.tags %}
    <meta property="article:tag" content="{{ tag }}">
    {% endfor %}
    {% endif %}
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@pythonistas_gdl">
    <meta name="twitter:title" content="{{ article.title }}">
    <meta name="twitter:description" content="{% if article.summary %}{{ article.summary|striptags|truncate(160) }}{% else %}{{ article.content|striptags|truncate(160) }}{% endif %}">
    
    <!-- Image handling -->
    {% if article.image %}
    <meta property="og:image" content="{{ SITEURL }}/{{ article.image }}">
    <meta name="twitter:image" content="{{ SITEURL }}/{{ article.image }}">
    {% elif article.content and '{static}/images/' in article.content %}
    <!-- Try to extract first image from content -->
    {% set first_image = article.content|regex_replace('.*{static}/images/([^"\'\\s)]+).*', SITEURL + '/images/\\1') %}
    {% if first_image != article.content %}
    <meta property="og:image" content="{{ first_image }}">
    <meta name="twitter:image" content="{{ first_image }}">
    {% else %}
    <!-- Fallback to site logo -->
    <meta property="og:image" content="{{ SITEURL }}/theme/images/pythonistas-gdl-logo.png">
    <meta name="twitter:image" content="{{ SITEURL }}/theme/images/pythonistas-gdl-logo.png">
    {% endif %}
    {% else %}
    <!-- Fallback to site logo -->
    <meta property="og:image" content="{{ SITEURL }}/theme/images/pythonistas-gdl-logo.png">
    <meta name="twitter:image" content="{{ SITEURL }}/theme/images/pythonistas-gdl-logo.png">
    {% endif %}
    
    <!-- Image properties -->
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    <meta property="og:image:type" content="image/png">
    
{% elif page %}
    <!-- Page specific meta tags -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="{{ page.title }} - {{ SITENAME }}">
    <meta property="og:description" content="{% if page.summary %}{{ page.summary|striptags|truncate(160) }}{% else %}{{ page.content|striptags|truncate(160) }}{% endif %}">
    <meta property="og:url" content="{{ SITEURL }}/{{ page.url }}">
    <meta property="og:site_name" content="{{ SITENAME }}">
    <meta property="og:locale" content="es_MX">
    <meta property="og:image" content="{{ SITEURL }}/theme/images/pythonistas-gdl-logo.png">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@pythonistas_gdl">
    <meta name="twitter:title" content="{{ page.title }} - {{ SITENAME }}">
    <meta name="twitter:description" content="{% if page.summary %}{{ page.summary|striptags|truncate(160) }}{% else %}{{ page.content|striptags|truncate(160) }}{% endif %}">
    <meta name="twitter:image" content="{{ SITEURL }}/theme/images/pythonistas-gdl-logo.png">
    
{% else %}
    <!-- Homepage/default meta tags -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="{{ SITENAME }}{% if SITESUBTITLE %} - {{ SITESUBTITLE }}{% endif %}">
    <meta property="og:description" content="Comunidad de desarrolladores Python en Guadalajara, México. Únete a nuestras reuniones mensuales, charlas técnicas y networking con otros pythonistas.">
    <meta property="og:url" content="{{ SITEURL }}">
    <meta property="og:site_name" content="{{ SITENAME }}">
    <meta property="og:locale" content="es_MX">
    <meta property="og:image" content="{{ SITEURL }}/theme/images/pythonistas-gdl-logo.png">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@pythonistas_gdl">
    <meta name="twitter:title" content="{{ SITENAME }}{% if SITESUBTITLE %} - {{ SITESUBTITLE }}{% endif %}">
    <meta name="twitter:description" content="Comunidad de entusiastas de Python en Guadalajara, México. Únete a nuestras reuniones mensuales, charlas técnicas y networking con otros pythonistas.">
    <meta name="twitter:image" content="{{ SITEURL }}/theme/images/pythonistas-gdl-logo.png">
{% endif %}

<!-- Additional SEO meta tags -->
<meta name="description" content="{% if article %}{% if article.summary %}{{ article.summary|striptags|truncate(160) }}{% else %}{{ article.content|striptags|truncate(160) }}{% endif %}{% elif page %}{% if page.summary %}{{ page.summary|striptags|truncate(160) }}{% else %}{{ page.content|striptags|truncate(160) }}{% endif %}{% else %}{{ SITE_DESCRIPTION }}{% endif %}">

<meta name="keywords" content="{% if article %}{% if article.tags %}{% for tag in article.tags %}{{ tag }}, {% endfor %}{% endif %}{% if article.category %}{{ article.category }}, {% endif %}{% endif %}{{ SITE_KEYWORDS }}">

<!-- Language and locale -->
<meta name="language" content="es">
<meta name="geo.region" content="MX-JAL">
<meta name="geo.placename" content="Guadalajara">
<meta name="geo.position" content="20.659698;-103.349609">
<meta name="ICBM" content="20.659698, -103.349609">

<!-- Additional meta tags -->
<meta name="theme-color" content="#7db904">
<meta name="msapplication-TileColor" content="#7db904">

<!-- Canonical URL -->
<link rel="canonical" href="{% if article %}{{ SITEURL }}/{{ article.url }}{% elif page %}{{ SITEURL }}/{{ page.url }}{% else %}{{ SITEURL }}{% endif %}">

<!-- Alternate language -->
<link rel="alternate" hreflang="es" href="{% if article %}{{ SITEURL }}/{{ article.url }}{% elif page %}{{ SITEURL }}/{{ page.url }}{% else %}{{ SITEURL }}{% endif %}">
<link rel="alternate" hreflang="es-mx" href="{% if article %}{{ SITEURL }}/{{ article.url }}{% elif page %}{{ SITEURL }}/{{ page.url }}{% else %}{{ SITEURL }}{% endif %}">
{% endblock %}
